# Analyse configuration Cisco avec assistance IA

## Objectif

Analyser rapidement des configurations de switchs/routeurs Cisco pour identifier des erreurs, incohÃ©rences ou problÃ¨mes de sÃ©curitÃ© en exploitant l'IA pour dÃ©tecter automatiquement les anomalies et proposer des corrections alignÃ©es avec les best practices.

## Contexte entreprise

Une PME de 80 employÃ©s dispose d'une infrastructure rÃ©seau Cisco :
- 5 switchs Catalyst 2960 (accÃ¨s)
- 2 switchs Catalyst 3750 (distribution)
- 1 routeur Cisco ISR 4331 (WAN)
- Configuration manuelle accumulÃ©e sur 5 ans
- Multiples administrateurs successifs
- Documentation inexistante ou obsolÃ¨te

**ProblÃ¨me** : Configurations devenues complexes, difficiles Ã  auditer, avec risque d'erreurs impactant la sÃ©curitÃ© et les performances.

**Objectif** : Auditer toutes les configurations en 2 jours au lieu de 2 semaines.

## ProblÃ¨me

Analyser manuellement des configurations Cisco implique :
- Lire des milliers de lignes de configuration
- Comparer avec les best practices Cisco
- Identifier les incohÃ©rences entre Ã©quipements
- DÃ©tecter les failles de sÃ©curitÃ© (VLAN natifs, telnet actif, etc.)
- VÃ©rifier l'alignation avec la documentation

**Temps estimÃ©** : 2-3 heures par Ã©quipement = 16-24 heures pour 8 Ã©quipements

**DifficultÃ©s** :
- Syntaxe Cisco parfois cryptique
- Configurations longues et denses
- Besoin d'expertise rÃ©seau approfondie
- Risque d'oublier des problÃ¨mes critiques

## Solution traditionnelle

### MÃ©thode manuelle

```bash
# Connexion au switch
ssh admin@192.168.1.10

# Export configuration
show running-config > switch1-config.txt

# Analyse manuelle ligne par ligne
# VÃ©rification VLAN, trunk, STP, sÃ©curitÃ©...
# Recherche dans documentation Cisco
```

**ProblÃ¨mes** :
- Fastidieux et chronophage
- Risque d'oubli de problÃ¨mes
- NÃ©cessite expertise Cisco avancÃ©e
- Pas de comparaison automatique entre Ã©quipements

## Apport de l'IA

L'IA permet de :
- Analyser instantanÃ©ment des configurations longues
- Identifier automatiquement les erreurs de configuration
- DÃ©tecter les failles de sÃ©curitÃ©
- Comparer avec les best practices Cisco
- GÃ©nÃ©rer un rapport d'audit structurÃ©
- Proposer des corrections concrÃ¨tes

**Temps avec IA** : 15-30 minutes par Ã©quipement

**Gain de productivitÃ©** : 80-85%

## Mise en Å“uvre Ã©tape par Ã©tape

### Ã‰tape 1 : Extraction des configurations

**Action** : RÃ©cupÃ©rer la running-config de chaque Ã©quipement

```bash
#!/bin/bash
# collect-cisco-configs.sh

DEVICES=("192.168.1.10" "192.168.1.11" "192.168.1.12" "192.168.1.20" "192.168.1.21" "192.168.1.30")
USERNAME="admin"
OUTPUT_DIR="./cisco-configs"

mkdir -p "$OUTPUT_DIR"

for device in "${DEVICES[@]}"; do
    echo "Collecte config: $device"

    # SSH avec expect ou sshpass
    sshpass -p "$PASSWORD" ssh -o StrictHostKeyChecking=no "$USERNAME@$device" "show running-config" > "$OUTPUT_DIR/$device.txt"

    if [ $? -eq 0 ]; then
        echo "OK: $device"
    else
        echo "ERREUR: $device"
    fi
done

echo "Configurations collectÃ©es dans $OUTPUT_DIR"
```

**RÃ©sultat** : 8 fichiers .txt avec les running-config complÃ¨tes

### Ã‰tape 2 : Analyse initiale avec l'IA

**Prompt** :

```
Analyse cette configuration Cisco Catalyst 2960.

Configuration :
[Copier-coller le contenu du fichier switch1-config.txt]

Identifie :
1. ProblÃ¨mes de sÃ©curitÃ© (telnet, VLAN natif 1, pas de port-security)
2. Erreurs de configuration (incohÃ©rences, doublons)
3. Non-respect des best practices Cisco
4. Suggestions d'amÃ©lioration

Format : Liste structurÃ©e avec niveau de criticitÃ© (CRITIQUE/MOYEN/FAIBLE)
```

**RÃ©ponse IA** :

```
=== AUDIT CONFIGURATION SWITCH 192.168.1.10 ===

[CRITIQUE] SÃ©curitÃ©
1. Telnet activÃ© (ligne vty 0-4)
   â†’ Risque : Trafic non chiffrÃ©
   â†’ Correction : DÃ©sactiver telnet, utiliser SSH uniquement

2. VLAN natif sur trunk = VLAN 1
   â†’ Risque : VLAN hopping attack
   â†’ Correction : Changer native VLAN sur tous les trunks

3. Aucun port-security configurÃ©
   â†’ Risque : MAC flooding, connexions non autorisÃ©es
   â†’ Correction : Activer port-security sur ports d'accÃ¨s

4. Mot de passe enable en clair
   â†’ Risque : Compromission du mot de passe
   â†’ Correction : Utiliser "enable secret" au lieu de "enable password"

[MOYEN] Configuration
5. STP mode PVST+ (dÃ©faut)
   â†’ AmÃ©lioration : Migrer vers Rapid-PVST+ pour convergence plus rapide

6. Logging non configurÃ©
   â†’ AmÃ©lioration : Activer logging vers serveur syslog

7. SNMP v2c actif (community public)
   â†’ Risque : AccÃ¨s non sÃ©curisÃ© aux statistiques
   â†’ Correction : Migrer vers SNMPv3 ou dÃ©sactiver

[FAIBLE] Optimisation
8. Pas de description sur les interfaces
   â†’ AmÃ©lioration : Ajouter des descriptions claires

9. Pas de banner de connexion
   â†’ AmÃ©lioration : Ajouter un banner lÃ©gal

10. NTP non configurÃ©
    â†’ AmÃ©lioration : Configurer synchronisation NTP
```

### Ã‰tape 3 : Demander les corrections Ã  l'IA

**Prompt** :

```
GÃ©nÃ¨re les commandes Cisco pour corriger les problÃ¨mes CRITIQUES identifiÃ©s.

ProblÃ¨mes :
1. Telnet activÃ©
2. VLAN natif = 1 sur trunks
3. Pas de port-security
4. Mot de passe enable en clair

Format : Commandes Cisco copy-paste ready avec commentaires
```

**RÃ©ponse IA** :

```cisco
! ===================================
! CORRECTIONS SÃ‰CURITÃ‰ - SWITCH 192.168.1.10
! ===================================

! 1. DÃ©sactiver Telnet et forcer SSH
line vty 0 4
 transport input ssh
 login local
 exec-timeout 5 0
exit

! VÃ©rifier que SSH est configurÃ©
ip domain-name entreprise.local
crypto key generate rsa modulus 2048

! 2. Changer VLAN natif sur tous les trunks
vlan 999
 name NATIVE_VLAN_UNUSED
exit

interface range GigabitEthernet0/1-2
 switchport trunk native vlan 999
 switchport trunk allowed vlan 10,20,30,999
exit

! 3. Activer port-security sur ports d'accÃ¨s (exemple VLAN 10)
interface range FastEthernet0/1-24
 switchport mode access
 switchport access vlan 10
 switchport port-security
 switchport port-security maximum 2
 switchport port-security violation restrict
 switchport port-security mac-address sticky
 spanning-tree portfast
 spanning-tree bpduguard enable
exit

! 4. Corriger mot de passe enable
no enable password
enable secret Str0ng!P@ss2024

! Sauvegarder
write memory
```

### Ã‰tape 4 : Comparaison multi-Ã©quipements

**Prompt** :

```
Compare ces 3 configurations de switchs Cisco.

Switch 1 (192.168.1.10) :
[Configuration switch1]

Switch 2 (192.168.1.11) :
[Configuration switch2]

Switch 3 (192.168.1.12) :
[Configuration switch3]

Identifie :
1. IncohÃ©rences (VLAN dÃ©clarÃ©s diffÃ©remment, STP root diffÃ©rent)
2. Configurations manquantes sur certains Ã©quipements
3. DiffÃ©rences de sÃ©curitÃ© entre les switchs

Format : Tableau comparatif
```

**RÃ©ponse IA** :

```
=== COMPARAISON CONFIGURATIONS ===

| ParamÃ¨tre              | Switch1 (.10) | Switch2 (.11) | Switch3 (.12) | IncohÃ©rence ? |
|------------------------|---------------|---------------|---------------|---------------|
| VLAN 10 (nom)          | ADMIN         | ADMIN         | Administratif | OUI âš ï¸        |
| VLAN 20 (nom)          | USERS         | UTILISATEURS  | USERS         | OUI âš ï¸        |
| VLAN natif trunk       | 1             | 999           | 1             | OUI ðŸ”´        |
| SSH activÃ©             | Oui           | Oui           | Non (telnet)  | OUI ðŸ”´        |
| Port-security          | Non           | Non           | Non           | CohÃ©rent      |
| STP Root Priority      | 32768 (def)   | 4096          | 32768 (def)   | IncohÃ©rent    |
| Logging server         | Non configurÃ© | 10.0.0.50     | Non configurÃ© | OUI âš ï¸        |
| NTP server             | Non configurÃ© | Non configurÃ© | Non configurÃ© | CohÃ©rent      |

PROBLÃˆMES CRITIQUES :
1. Switch3 utilise encore Telnet â†’ SÃ©curitÃ© compromise
2. VLAN natif incohÃ©rent (Switch2=999, autres=1) â†’ Risque trunk non fonctionnel
3. Nommage VLAN incohÃ©rent â†’ Confusion documentation

RECOMMANDATIONS :
1. Uniformiser VLAN natif Ã  999 partout
2. Activer SSH sur Switch3
3. Standardiser les noms de VLAN
4. DÃ©finir un STP root primary sur Switch2 et secondary sur Switch1
```

### Ã‰tape 5 : GÃ©nÃ©ration du rapport d'audit

**Prompt** :

```
GÃ©nÃ¨re un rapport d'audit complet en Markdown.

Analyse :
[Copier les rÃ©ponses des prompts prÃ©cÃ©dents]

Le rapport doit contenir :
1. RÃ©sumÃ© exÃ©cutif
2. CriticitÃ© par Ã©quipement (score/10)
3. Top 5 des problÃ¨mes prioritaires
4. Plan de remÃ©diation Ã©tape par Ã©tape
5. Estimation du temps de correction

Format : Markdown professionnel pour management
```

**RÃ©ponse IA (extrait)** :

```markdown
# Rapport d'Audit Infrastructure RÃ©seau Cisco

**Date** : 2024-01-15
**Auditeur** : Service IT
**PÃ©rimÃ¨tre** : 8 Ã©quipements Cisco (5x Catalyst 2960, 2x Catalyst 3750, 1x ISR 4331)

## 1. RÃ©sumÃ© exÃ©cutif

L'audit a rÃ©vÃ©lÃ© **12 problÃ¨mes de sÃ©curitÃ© critiques** et **18 non-conformitÃ©s** aux best practices Cisco.

**Niveau de risque global** : Ã‰LEVÃ‰ ðŸ”´

**Principales vulnÃ©rabilitÃ©s** :
- 3 Ã©quipements exposÃ©s via Telnet (trafic non chiffrÃ©)
- VLAN natif par dÃ©faut (VLAN 1) sur 6 Ã©quipements â†’ Risque VLAN hopping
- Aucun port-security configurÃ© â†’ Risque MAC flooding
- Mots de passe en clair dans certaines configurations

**Temps de remÃ©diation estimÃ©** : 16 heures (2 jours)
**CoÃ»t** : Interne (pas d'investissement matÃ©riel nÃ©cessaire)

## 2. Score de sÃ©curitÃ© par Ã©quipement

| Ã‰quipement           | IP           | Score | CriticitÃ© |
|----------------------|--------------|-------|-----------|
| Switch1 (Catalyst)   | 192.168.1.10 | 4/10  | ðŸ”´ Ã‰LEVÃ‰  |
| Switch2 (Catalyst)   | 192.168.1.11 | 6/10  | ðŸŸ  MOYEN  |
| Switch3 (Catalyst)   | 192.168.1.12 | 3/10  | ðŸ”´ Ã‰LEVÃ‰  |
| Switch4 (Catalyst)   | 192.168.1.13 | 4/10  | ðŸ”´ Ã‰LEVÃ‰  |
| Switch5 (Catalyst)   | 192.168.1.14 | 5/10  | ðŸŸ  MOYEN  |
| Core1 (3750)         | 192.168.1.20 | 7/10  | ðŸŸ¡ FAIBLE |
| Core2 (3750)         | 192.168.1.21 | 7/10  | ðŸŸ¡ FAIBLE |
| Router1 (ISR)        | 192.168.1.30 | 5/10  | ðŸŸ  MOYEN  |

## 3. Top 5 des problÃ¨mes prioritaires

1. **Telnet actif sur 3 Ã©quipements**
   - CriticitÃ© : CRITIQUE
   - Impact : Interception des mots de passe administrateur
   - RemÃ©diation : 30 minutes

2. **VLAN natif = 1 sur les trunks**
   - CriticitÃ© : CRITIQUE
   - Impact : Attaque VLAN hopping possible
   - RemÃ©diation : 2 heures

3. **Absence de port-security**
   - CriticitÃ© : Ã‰LEVÃ‰
   - Impact : Connexions non autorisÃ©es, MAC flooding
   - RemÃ©diation : 4 heures

4. **Mots de passe en clair**
   - CriticitÃ© : Ã‰LEVÃ‰
   - Impact : Compromission d'accÃ¨s si config exposÃ©e
   - RemÃ©diation : 30 minutes

5. **Pas de logging centralisÃ©**
   - CriticitÃ© : MOYEN
   - Impact : DifficultÃ© Ã  tracer incidents
   - RemÃ©diation : 1 heure

## 4. Plan de remÃ©diation

### Phase 1 : Urgence (Jour 1 - 4h)
- [ ] DÃ©sactiver Telnet partout, forcer SSH
- [ ] Changer mots de passe enable en secrets
- [ ] Modifier VLAN natif sur tous les trunks

### Phase 2 : SÃ©curisation (Jour 1-2 - 8h)
- [ ] Configurer port-security sur tous les ports d'accÃ¨s
- [ ] Activer BPDU Guard sur ports accÃ¨s
- [ ] Configurer logging vers serveur syslog

### Phase 3 : Optimisation (Jour 2 - 4h)
- [ ] Migrer STP vers Rapid-PVST+
- [ ] Configurer NTP
- [ ] Ajouter descriptions sur interfaces
- [ ] CrÃ©er banner de connexion

**Total** : 16 heures
```

### Ã‰tape 6 : Application des corrections

**Action** : Appliquer les configurations gÃ©nÃ©rÃ©es par l'IA en environnement de maintenance

```bash
# Sauvegarde avant modification
for device in "${DEVICES[@]}"; do
    sshpass -p "$PASSWORD" ssh "$USERNAME@$device" "show running-config" > "backup-$device-$(date +%Y%m%d).txt"
done

# Application manuelle des commandes de correction
# Connexion au switch
ssh admin@192.168.1.10

# Copier-coller les commandes gÃ©nÃ©rÃ©es par l'IA
# Tester la connectivitÃ© aprÃ¨s chaque modification
```

**Validation** : VÃ©rifier que les corrections n'ont pas cassÃ© la connectivitÃ©

## Scripts / Commandes / Configurations

### Script de collecte automatique

```bash
#!/bin/bash
# cisco-config-collector.sh
# Collecte automatique des configurations Cisco

DEVICES_FILE="devices.txt"
USERNAME="admin"
OUTPUT_DIR="./configs-$(date +%Y%m%d)"

mkdir -p "$OUTPUT_DIR"

while IFS= read -r device; do
    echo "[$(date '+%H:%M:%S')] Collecte: $device"

    timeout 30 sshpass -p "$PASSWORD" ssh -o StrictHostKeyChecking=no \
        -o ConnectTimeout=10 "$USERNAME@$device" \
        "show running-config" > "$OUTPUT_DIR/$device.txt" 2>&1

    if [ $? -eq 0 ]; then
        echo "  âœ“ OK"
    else
        echo "  âœ— ERREUR"
    fi

    sleep 2
done < "$DEVICES_FILE"

echo ""
echo "Configurations sauvegardÃ©es dans: $OUTPUT_DIR"
ls -lh "$OUTPUT_DIR"
```

### Fichier devices.txt

```
192.168.1.10
192.168.1.11
192.168.1.12
192.168.1.13
192.168.1.14
192.168.1.20
192.168.1.21
192.168.1.30
```

### Template de configuration sÃ©curisÃ©e

```cisco
! ===================================
! TEMPLATE SÃ‰CURITÃ‰ CISCO SWITCH
! BasÃ© sur Cisco Best Practices
! ===================================

! === Hostname et domaine ===
hostname SWITCH-XX
ip domain-name entreprise.local

! === Mots de passe ===
enable secret 5 [hash gÃ©nÃ©rÃ©]
service password-encryption

! === Utilisateur local ===
username admin privilege 15 secret 5 [hash]

! === VLANs ===
vlan 10
 name ADMIN
vlan 20
 name USERS
vlan 30
 name SERVERS
vlan 999
 name NATIVE_UNUSED

! === SSH ===
crypto key generate rsa modulus 2048
ip ssh version 2
ip ssh time-out 60
ip ssh authentication-retries 3

! === VTY (accÃ¨s distant) ===
line vty 0 4
 transport input ssh
 login local
 exec-timeout 5 0
 logging synchronous
exit

! === Console ===
line console 0
 login local
 exec-timeout 5 0
 logging synchronous
exit

! === Trunks ===
interface range GigabitEthernet0/1-2
 description TRUNK vers CORE
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk native vlan 999
 switchport trunk allowed vlan 10,20,30,999
 spanning-tree guard root
exit

! === Ports d'accÃ¨s (exemple VLAN 10) ===
interface range FastEthernet0/1-24
 description POSTES ADMINISTRATIFS
 switchport mode access
 switchport access vlan 10
 switchport port-security
 switchport port-security maximum 2
 switchport port-security violation restrict
 switchport port-security mac-address sticky
 spanning-tree portfast
 spanning-tree bpduguard enable
 no cdp enable
exit

! === STP ===
spanning-tree mode rapid-pvst
spanning-tree extend system-id
spanning-tree vlan 10,20,30 priority 8192

! === Logging ===
logging buffered 51200
logging host 10.0.0.50
logging trap informational
logging source-interface Vlan10

! === NTP ===
ntp server 10.0.0.100 prefer

! === SNMP (v3 recommandÃ©) ===
! snmp-server group MONIT v3 priv
! snmp-server user snmpadmin MONIT v3 auth sha AuthPass123 priv aes 128 PrivPass456

! === Banner ===
banner login ^C
*****************************************************************
* ACCES RESERVE - Entreprise XYZ                               *
* Tout acces non autorise sera poursuivi                        *
* Les connexions sont enregistrees et monitorees                *
*****************************************************************
^C

! === Sauvegarder ===
end
write memory
```

### Commandes de vÃ©rification post-correction

```cisco
! VÃ©rifier SSH actif
show ip ssh

! VÃ©rifier VLAN natif
show interfaces trunk

! VÃ©rifier port-security
show port-security interface FastEthernet0/1

! VÃ©rifier logging
show logging

! VÃ©rifier NTP
show ntp status

! VÃ©rifier STP root
show spanning-tree root
```

## Risques et limites

### Risques de l'automatisation

**Erreurs de copier-coller** : Les commandes gÃ©nÃ©rÃ©es par l'IA doivent Ãªtre relues avant application. Une erreur peut couper la connectivitÃ©.

**Perte de connectivitÃ©** : Modifier le VLAN natif ou SSH peut couper l'accÃ¨s au switch. Toujours avoir un accÃ¨s console de secours.

**Impact production** : Les modifications rÃ©seau doivent Ãªtre testÃ©es en maintenance ou sur un switch de test d'abord.

### Limites de l'IA

**Contexte incomplet** : L'IA analyse ce qu'on lui fournit. Si la configuration est tronquÃ©e, l'analyse peut Ãªtre incomplÃ¨te.

**Configurations custom** : Des setups spÃ©cifiques (QoS avancÃ©, multicast, stacking) peuvent nÃ©cessiter expertise manuelle.

**CompatibilitÃ© version** : L'IA peut proposer des commandes pour IOS rÃ©cent sur du matÃ©riel ancien. VÃ©rifier la compatibilitÃ©.

### Risques opÃ©rationnels

**Sauvegarde obligatoire** : Toujours sauvegarder la running-config avant modification (`write memory` + export).

**FenÃªtre de maintenance** : Planifier les modifications en heures creuses avec validation client.

## Bonnes pratiques

### Avant l'audit

1. Sauvegarder toutes les running-config
2. Documenter la topologie rÃ©seau
3. Identifier les fenÃªtres de maintenance possibles
4. PrÃ©parer un accÃ¨s console de secours

### Pendant l'analyse IA

1. Fournir la configuration complÃ¨te (pas tronquÃ©e)
2. PrÃ©ciser le modÃ¨le et version IOS
3. Indiquer le contexte d'utilisation (production, critique, etc.)
4. Demander des explications pour les recommandations

### AprÃ¨s l'audit

1. Relire toutes les commandes gÃ©nÃ©rÃ©es par l'IA
2. Tester les corrections sur un switch de lab si possible
3. Appliquer les modifications en maintenance planifiÃ©e
4. Valider chaque Ã©tape avant de passer Ã  la suivante
5. Documenter les changements effectuÃ©s

### Documentation

1. CrÃ©er un repository Git des configurations
2. Versionner chaque modification
3. Maintenir un changelog des corrections
4. CrÃ©er des runbooks pour les configurations types

## Ce que cela dÃ©montre Ã  un recruteur

### CompÃ©tences techniques

- Expertise Cisco (switchs, routeurs, IOS)
- MaÃ®trise des concepts rÃ©seau (VLAN, STP, trunking, sÃ©curitÃ©)
- CapacitÃ© d'audit et d'analyse de configurations complexes
- Connaissance des best practices de sÃ©curitÃ© rÃ©seau

### EfficacitÃ©

- RÃ©duction du temps d'audit de 80-85%
- Analyse rapide de configurations longues
- Identification automatique de failles critiques
- GÃ©nÃ©ration de rapports professionnels pour le management

### Utilisation stratÃ©gique de l'IA

- Analyse de configurations multi-Ã©quipements
- GÃ©nÃ©ration de commandes de correction
- Production de documentation structurÃ©e
- Gain de temps massif sans compromis sur la qualitÃ©

**Message au recruteur** : Ce guide dÃ©montre un administrateur rÃ©seau capable d'auditer rapidement une infrastructure Cisco complexe en exploitant l'IA pour accÃ©lÃ©rer l'analyse. La mÃ©thode est rigoureuse (collecte â†’ analyse â†’ comparaison â†’ correction â†’ validation), garantissant un audit complet et des corrections alignÃ©es avec les standards Cisco.
